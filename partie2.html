<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hello, World! • A-Frame</title>
    <meta name="description" content="Hello, World! • A-Frame">
    <script src="https://aframe.io/releases/0.2.0/aframe.min.js"></script>
    		<script src="aframe-obj-loader-component.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <a-asset-item id="penguin" src="penguin.obj"></a-asset-item>
        <a-asset-item id="penguin-mtl" src="penguin.mtl"></a-asset-item>
      </a-assets>

      <!-- <a-sphere radius="0.2" ></a-sphere>
      <a-cylinder height="2.0" color="green"  radius="0.05" translate="0 1.0 0"></a-cylinder>
      <a-cylinder height="2.0" color="red"   radius="0.05" translate="0 1.0 0" rotation="0 0 -90"></a-cylinder>
      <a-cylinder height="2.0" color="blue" radius="0.05" translate="0 1.0 0" rotation="90 0 0"></a-cylinder> -->

      <!-- <a-sky color="#ECECEC"></a-sky> -->
      <!-- <a-plane height="100" width="100" position="0 0 -50"></a-plane> -->



       <!-- <a-entity id="Tux" rotation="0 0 0" position="0 0 0" geometry="primitive: box; radius: 0.5">
            <a-cylinder height="2.0" color="blue" radius="0.05" translate="0 1.0 0" rotation="90 0 0"></a-cylinder>
        </a-entity> -->

<a-sky color="#6EBAA7"></a-sky>

  <a-entity
   obj-loader="src: url(obj/penguin.obj); mtl: url(obj/penguin.mtl);"
   id="Tux"
   rotation="0 0 0" position="0 0 0"
 ></a-entity>

 <a-entity
  obj-loader="src: url(obj/skin/Wooden_Table_2.obj); mtl: url(obj/skin/Wooden_Table_2.mtl);"
  rotation="0 0 0" position="0 0 0"
></a-entity>




        <!-- <a-entity camera look-controls>
          <a-entity cursor="fuse: false; maxDistance: 10000; timeout: 500"
                    position="0 0 -5"
                    material="color: black; shader: flat">
                    <a-ring color="black" radius-inner="0.05" radius-outer="0.1"></a-ring>
          </a-entity>
        </a-entity> -->

      <!-- </a-entity> -->


      <a-entity id="lookat" geometry="primitive: box; radius: 0.5" position="-12 0 -4">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;" geometry="primitive: box; radius: 0.5" position="-10 0 -2">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="-10 0 -4">
      </a-entity>


      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="-10 0 -6">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="-10 0 -8">
      </a-entity>

      <a-entity id="lookat2" geometry="primitive: box; radius: 0.5" position="12 0 -4">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="10 0 -2">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="10 0 -4">
      </a-entity>


      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="10 0 -6">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="10 0 -8">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="-2 0 -10">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="-4 0 -10">
      </a-entity>


      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="-6 0 -10">
      </a-entity>

      <a-entity class="test" id="test2" material="opacity:0.0;"geometry="primitive: box; radius: 0.5" position="-8 0 -10">
      </a-entity>


      <!-- <a-box id="Tux" position="0 0 -4" rotation="0 45 0" radius="0.5" height="1.5" color="#FFC65D">
        <a-cylinder height="2.0" color="blue" radius="0.05" translate="0 1.0 0" rotation="90 0 0"></a-cylinder>
      </a-box> -->

      <!-- <a-camera far="10000" position="0 2 5"
          fov="80"
          near="0.01"
          id="camera"
      ></a-camera> -->
    </a-scene>
    <script>
    // var target = 0;
    // var angle = 0;
    // document.querySelector('.test').addEventListener('click', function () {


    // });
var elements = document.getElementsByClassName("test");
var myTimer = 0;
var index = 0;
recursivefunction(elements);

function recursivefunction(elements)
{
  //clearInterval(myTimer);
  var target = elements[index];
  var orientation = 1;
  var zdirection = 1;
  var xdirection = 1;
  var xbool = false;
  var zbool = false;
  var orbool = true;
  var xpas = 0.05;
  var zpas = 0.05;
      var boolpas = true;
    var Tux = document.querySelector('#Tux');
      Tux.removeAttribute("look-at");
      var ztarget = target.getAttribute("position").z;
      var xtarget = target.getAttribute("position").x;
    var x = Tux.getAttribute("position").x;
        var z = Tux.getAttribute("position").z;
  //
  // var angleplus = ztarget > z? -180 : 0;
  myTimer = setInterval(function(){

    var Tux = document.querySelector('#Tux');
    var xtarget = target.getAttribute("position").x;
    var x = Tux.getAttribute("position").x;
    var ztarget = target.getAttribute("position").z;
    var z = Tux.getAttribute("position").z;
    var tangangle=(xtarget - x)/(ztarget - z);
    var angleplus = ztarget >= z? -180 : 0;



  var angle = Math.atan(tangangle) * 180/Math.PI + angleplus;
  angle+=180;

    zdirection = ztarget > z? 1 : -1;
    xdirection = xtarget > x? 1 : -1;

    if(orbool){
      orientation = angle > Tux.getAttribute("rotation").y ? 1 : -1;
      orbool = false;
    }



//
// if(boolpas)
// {
//
//   if(Math.abs(xtarget) > Math.abs(ztarget)){
//     xpas=0.05;
//     zpas=0.05/((Math.abs(xtarget)+ Math.abs(x)) /(Math.abs(ztarget) + Math.abs(z)));
//   }
//   else {
//     zpas=0.05;
//     xpas=0.05/((Math.abs(ztarget)+ Math.abs(z))/(Math.abs(xtarget) + Math.abs(x)));
//   }
//   boolpas = false;
// }



    var y_rotation = Tux.getAttribute("rotation").y + 5*orientation;

    if((y_rotation <= angle && orientation == -1) ||(y_rotation >= angle && orientation == 1) || angle == 0)
       y_rotation = angle;

    var z_position = Tux.getAttribute("position").z + zdirection*zpas;

    if((z_position > ztarget && zdirection == 1) || (z_position < ztarget && zdirection == -1))
    {
       z_position = ztarget;
       zbool = true;
    }
    var x_position = Tux.getAttribute("position").x + xdirection*xpas;
    if((x_position > xtarget && xdirection == 1) || (x_position < xtarget && xdirection == -1))
    {
       x_position = xtarget;
      xbool = true;
    }

   if(zbool && xbool)
   {
      index++;
      if(index < elements.length)
      {
        if(index > 4)
                Tux.setAttribute("look-at","#lookat2");
                else {
                    Tux.setAttribute("look-at","#lookat");
                }
        setTimeout(function() {
        recursivefunction(elements);

        }, 5000);
        clearInterval(myTimer);

      }
      else {
        if(index > 4)
                Tux.setAttribute("look-at","#lookat2");
                else {
                    Tux.setAttribute("look-at","#lookat");
                }
          clearInterval(myTimer);
      }
   }

    Tux.setAttribute('rotation', {x:0,y:y_rotation,z:0});

    if((y_rotation <= angle && orientation == -1) ||(y_rotation >= angle && orientation == 1) || angle == 0)
      Tux.setAttribute('position', {x:x_position,y:0,z:z_position});

  }, 50);
  }
    </script>
  </body>
</html>
